import PermissionsBasics from '../components/PermissionsBasics.mdx'
import { Link } from '@brillout/docpress'

## Basics

<PermissionsBasics />


## `getContext()` wrapping

To implement a permission once and re-use it, we can use a `getContext()` wrapper:

```ts
// components/TodoItem.telefunc.ts
// Environment: Server

export { onTextChange }

import { getUser } from '../auth/getUser'

function onTextChange(id: string, text: string) {
  const user = getUser()
  /* ... */
}
```

```ts
// auth/getUser.ts
// Environment: Node.js

// Note that getUser() isn't a telefunction: it's just a little wrapper around getContext()
export { getUser }

import { getContext, Abort } from 'telefunc'

function getUser() {
  const { user } = getContext()
  if (!user) {
    throw Abort({ notLoggedIn: true })
  }
  return user
}
```

```js
// Environment: Browser

import { onTelefunctionRemoteCallError } from 'telefunc/client'

// onTelefunctionRemoteCallError() is called whenever the browser-side fails to make
// a telefunction call, allowing us to implement global behavior like below
onTelefunctionRemoteCallError(err => {
  if (err.isAbort && err.abortValue.notLoggedIn) {
    // Redirect user to login page
    window.location.href = '/login'
  }
})
```

## See also

 - <Link href="/Abort" />
 - <Link href="/getContext" />
