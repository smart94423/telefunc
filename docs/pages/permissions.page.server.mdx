import PermissionsBasics from '../components/PermissionsBasics.mdx'
import TypeScriptGetContext from '../components/TypeScriptGetContext.mdx'

## Basics

<PermissionsBasics />


## TypeScript

<TypeScriptGetContext />


## `getContext()` wrapping

To implement permissions once and re-using them, we can use utility wrappers:

```ts
// components/TodoItem.telefunc.ts
// Environment: Server

export { onTextChange }

import { getUser } from '../auth/getUser'

function onTextChange(id: string, text: string) {
  const user = getUser()
  /* ... */
}
```

```ts
// auth/getUser.ts
// Environment: Node.js

// Note that `auth/getUser.ts` is not a `.telefunc.js` file and `getUser()` not a telefunction
export { getUser }

import { getContext, Abort } from 'telefunc'

function getUser() {
  const { user } = getContext()
  if (!user) {
    throw Abort({ notLoggedIn: true })
  }
  return user
}
```

```js
// Environment: Browser

import { onTelefunctionRemoteCallError } from 'telefunc/client'

onTelefunctionRemoteCallError(err => {
  if (err.isAbort && err.abortValue.notLoggedIn) {
    // Redirect user to login page
    window.location.href = '/login'
  }
})
```

> In general we recommend to use `return someValue` while using `throw Abort(someValue)` only when defining such global utility wrapper.
